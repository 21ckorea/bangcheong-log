
# 진행 상황 - 크롤러 및 프론트엔드 연동

## 완료된 기능

### 1. KBS 크롤러 구현
- **하이브리드 전략**:
    - **뮤직뱅크**: 내부 API (`/board/v1/list_board`)를 사용합니다.
    - **개그콘서트**: 별도의 티켓 시스템 (`kbsticket.kbs.co.kr`)을 스크래핑합니다.
- **인코딩 문제 해결**:
    - 티켓 시스템이 구형 `EUC-KR` 인코딩을 사용하여 텍스트 깨짐 현상(Mojibake)이 발생했습니다.
    - **해결**: `iconv-lite`를 사용하여 바이너리 응답 버퍼를 올바르게 디코딩했습니다.
    - **헤더**: 차단을 우회하기 위해 브라우저를 모방하는 헤더(`User-Agent`, `Referer`, `Sec-Fetch-*`)를 추가했습니다.
- **데이터 정리**:
    - **발표 날짜**: HTML에서 "발표" 날짜를 추출하여 신청 마감일(`applyEndDate`)로 사용했습니다.
    - **시간 파싱**: "2026.01.14 (수) 19:00"과 같은 문자열에서 HH:mm 시간을 파싱하도록 유틸리티를 업데이트했습니다.
    - **중복 방지**: 제목 + 방송사 + 날짜(YYYY-MM-DD)를 매칭하여 시간 정보가 없는 레코드와 있는 레코드를 병합하는 강력한 업서트 로직을 `route.ts`에 구현했습니다.

### 2. 프론트엔드 연동 (메인 페이지)
- **실제 데이터**: `HomeClient.tsx`는 이제 Postgres 데이터베이스에서 가져온 데이터를 렌더링합니다.
- **D-Day 뱃지**:
    - D-Day 계산 로직을 수정했습니다.
    - **UI 개선**: 가시성을 높이기 위해 반투명 스타일에서 단색 흰색/검은색 고대비 뱃지로 변경했습니다.
- **카드 레이아웃**:
    - **방송사 이름**: 겹침 방지를 위해 그라데이션 이미지 영역에서 콘텐츠 영역(카테고리 뱃지 옆)으로 이동했습니다.
    - **날짜 표시**: "방청일"과 "발표일"을 모두 표시합니다. 시간이 있으면 함께 표시됩니다 (예: `19:00`).
    - **상호작용**: "자세히 보기" 버튼을 클릭하면 실제 신청 링크가 새 탭에서 열립니다.

## 검증 결과
- **크롤러 테스트**: 다가오는 개그콘서트 티켓을 성공적으로 수집했습니다.
- **DB 확인**: Vercel Postgres에 데이터가 올바르게 저장되었음을 확인했습니다.
- **UI 확인**: 사용자가 올바른 날짜, 겹침 없음, 버튼 기능을 확인했습니다.

## 다음 단계
- **MBC** (쇼! 음악중심) 크롤러 구현.
- **SBS** (인기가요) 크롤러 구현.
- **사용자 인증** (로그인/회원가입) 구현.
